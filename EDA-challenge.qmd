---
title: "Exercise 03: EDA-challenge"
author: "John Hinkle"
format: html
editor: visual
---

## Exercise 03

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

### Load packages

```{r}
library(tidyverse)
library(magrittr)
library(ggplot2)
```

### Loading data file

```{r}
f <- "/Users/jeh5663/Documents/exercise-03/data-wrangling.csv"
d <- read_csv(f, col_names = TRUE)
```

Create BSD variable

```{r}
bmmm <- d$Body_mass_male_mean
bmfm <- d$Body_mass_female_mean
bsd <- bmmm / bmfm
d <- mutate(d, BSD = bsd)
```

Create sex_ratio variable

```{r}
females <- d$AdultFemale
males <- d$AdultMales
sr <- females / males
d <- mutate(d, sex_ratio = sr)
```

Create DI variable (ratio of day range length to the diameter of the home range)

```{r}
day_range_length <- d$DayLength_km
home_range_area <- d$HomeRange_km2
home_range_diamater <- (sqrt(home_range_area/pi))*2
di <- day_range_length / home_range_diamater
d <- mutate(d, DI = di)
```

Plot of day range length vs time spent moving, overall

```{r}
ggplot(d, aes(x=Move, y=DayLength_km)) + 
  geom_point(color="#BF5700")

ggplot(d, aes(x=Move, y=DayLength_km)) + 
  geom_point(color="#BF5700") +
  scale_x_log10() +
  scale_y_log10()
```

Plot of day range length vs time spent moving, by Family

```{r}
ggplot(d, aes(x=Move, y=DayLength_km)) + 
  geom_point(color="#BF5700") +
  facet_wrap(~Family)
```

Plot of day range length vs group size, overall

```{r}
ggplot(d, aes(x=MeanGroupSize, y=DayLength_km)) + 
  geom_point(color="#BF5700")
```

Plot of day range length vs group size, by Family

```{r}
ggplot(d, aes(x=MeanGroupSize, y=DayLength_km)) + 
  geom_point(color="#BF5700") +
  facet_wrap(~Family)
```

Plot of canine size dimorphism vs body size dimorphism, overall

```{r}
ggplot(d, aes(x=BSD, y=Canine_Dimorphism)) + 
  geom_point(color="#BF5700")
```

Plot of canine size dimorphism vs body size dimorphism, by Family

```{r}
ggplot(d, aes(x=BSD, y=Canine_Dimorphism)) + 
  geom_point(color="#BF5700") +
  facet_wrap(~Family)
```

```{r}
d <- mutate(d, diet = ifelse(Fruit >= 50, "frugivore", ifelse(Leaves >= 50, "folivore",
    ifelse(Fruit < 50 & Leaves < 50, "omnivore", NA))))
```


```{r}

```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
